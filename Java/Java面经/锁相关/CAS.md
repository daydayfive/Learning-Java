# CAS


##CAS 是什么？

CAS 全称为 compare and swap，比较并交换，是一个原子性的操作。


##CAS操作

CAS有三个操作数： 当前值A，内存值V，要修改的新值B

假设 当前值A 跟内存值V 相等，那就将内存值V改为B

假设 当前值A 跟内存值V 不相等， 要么就重试，要么就放弃更新

将当前值与内存值进行对比，判断是否有被修改过，这就是CAS的核心



##为什么要用CAS？
CAS 相当于**没有加锁**，多个线程都可以直接操作共享资源，在实际去修改的时候才会判断是否会成功。

比synchorinized锁要高效很多






##CAS的缺点

1. 会带来ABA问题：假设线程A读到当前值是10，线程B把值修改到100，然后线程C把值修改到10，对线程A拿到执行权的时候，因为当前值和内存值是一致的，可以修改
   对于ABA问题，可以加个时间戳来改进

2. CAS只能对一个变量进行修改

3. 循环时间长开销大：自旋CAS操作如果不成功就一直循环执行直到成功，如果长时间不成功，会给CPU带来非常大的执行开销