#数据库
[TOC]


##175.组合两个表

![图 2](../../images/279e1ef077dad8f947533ed88dd39f10b2d27772cdb784289dd239dbcfb72bec.png)  

* 代码
```sql
select FirstName, LastName,City,State from Person as p left outer join Address as a on p.PersonId = a.PersonId;
```

##176.第二高的薪水
![图 3](../../images/d75b207ed51b7884e44fe653c909367c93e4acf910657c20dad7c94302f2210b.png)  

* 代码
  
```sql
select (select DISTINCT Salary  from Employee order by Salary desc limit 1,1) as SecondHighestSalary;
```


##177.第N高的薪水
![图 4](../../images/b5388d2da96260f290be913f65ad25f5fe2c26b2c5c9aa3ff17e6e27da418eb6.png)  

* 代码

```sql
CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
BEGIN
  SET N = N-1;
  RETURN (
      # Write your MySQL query statement below.
     select DISTINCT Salary from Employee order by Salary desc limit N,1
  );
END

```


##178.分数排名
![图 5](../../images/75b8b89ef122d73c57e92766819c79009b3030edb5d40615465c2b7c35e8275a.png)  
* 代码
```sql
select a.Score as Score,
(select count(DISTINCT b.Score) from Scores as b where b.Score>=a.Score) as `Rank`
from Scores as a  order by Score DESC
```


##180.连续出现的数字
![图 6](../../images/74115fff5b357f4e4b91c39e84e82488eb862d0ba5c93e531a562446bc03ee10.png)  

* 代码
```sql
select DISTINCT(l1.Num) as ConsecutiveNums
from Logs as l1,Logs as l2,Logs as l3
where l1.Id=l2.Id-1 and l1.Num=l2.Num
  and l2.Id=l3.Id-1 and l2.num=l3.num
```


##181.超过经理收入的员工
![图 7](../../images/2e4b7cc89761c999ac409b28201339851a04da66f42fca7bfde8bdff575250a3.png)  
* 代码
```sql
select a.Name as 'Employee'
from Employee as a,Employee as b
where a.ManagerId=b.Id
and a.Salary >b.Salary
```


##182.查找重复的电子邮箱
![图 8](../../images/3bae71965dae91af964def952173796263771a5a07c6f1a8c1c3d8ce36195cac.png)  
* 代码
```sql
select Email from
(select Email, count(Email) as num from Person group by Email) as a
where num>1

```
临时表需要有别名


##183.从不订购的客户
![图 9](../../images/73326e20c83d832329497b0c14f7d00dd2b47d0504b195e5c9aebe82899e2857.png)  

* 代码
```sql
select a.Name  as 'Customers'
from Customers as a
where a.Id NOT IN(
    select CustomerId from Orders
)

```

##184.部门工资最高的员工
![图 1](../../images/70e88d0f9e7d46218b23aa8fba9a985b3fb1c5bf92ca49e917f1e45ad8a52f51.png)  

* 代码
```sql
select Department.Name as 'Department', Employee.Name as 'Employee', Salary
from  Department join Employee on Employee.DepartmentId =Department.Id 
where (Department.Id,Salary) IN
(select DepartmentId,max(Salary) from Employee group by DepartmentId)
```


##185.部分工资前三高的所有员工
![图 2](../../images/b1e8c55b6189a4329996d0d0701868c4e36aab6fca06042ce03ee96d15a24477.png)  

* 代码
```sql

```